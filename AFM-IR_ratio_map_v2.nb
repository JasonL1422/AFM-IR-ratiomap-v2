(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50515,       1217]
NotebookOptionsPosition[     46566,       1141]
NotebookOutlinePosition[     46957,       1157]
CellTagsIndexPosition[     46914,       1154]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Ver.2 (nx x ny data in one column, in .txt)", "Section",
 CellChangeTimes->{{3.9292688259114227`*^9, 3.9292688895458403`*^9}, {
  3.929274189175351*^9, 
  3.929274199367347*^9}},ExpressionUUID->"42dd79a8-9e1a-4531-a964-\
7af2f58b26f6"],

Cell[CellGroupData[{

Cell[BoxData[{"$Version", "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Mathematica", " ", "file", " ", "in", " ", "the", " ", "proper", " ", 
    "location"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.917665889227344*^9, 3.917665891170557*^9}, {
  3.929269563881402*^9, 3.9292695693747473`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"423c22fd-5ae2-41cd-8e14-d2d388ab648f"],

Cell[BoxData["\<\"12.3.0 for Mac OS X x86 (64-bit) (May 10, 2021)\"\>"], \
"Output",
 CellChangeTimes->{3.9176658927739677`*^9, 3.92921953982778*^9, 
  3.929264587301249*^9, 3.929268605796288*^9, 3.9292686401987543`*^9, 
  3.929269935584139*^9, 3.929271362076686*^9, 3.929272024806582*^9, 
  3.9292722592646008`*^9, 3.929272292621902*^9, 3.929272588414382*^9, 
  3.929273117512312*^9, 3.929273415348962*^9, 3.9292740943643312`*^9, 
  3.929274302881239*^9, 3.9292748905229397`*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"c4560d50-35a9-46f3-ac83-ea3c82f505b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["a. Data import and process",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.929269752906913*^9, 
  3.929269761786269*^9}},ExpressionUUID->"30c63f09-c0ac-4c05-a2b2-\
d6085e53c6de"],

Cell[CellGroupData[{

Cell["0. Data information", "Subsubsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}},ExpressionUUID->"1cbcbd63-82e0-4d65-8ad0-\
0b586ceb661b"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"Lx", "=", "5"}], ";"}],
   Background->RGBColor[1, 1, 0]], 
  RowBox[{"(*", 
   RowBox[{"um", "-", 
    RowBox[{"scanned", " ", "area"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"Ly", "=", "5"}], ";"}],
   Background->RGBColor[1, 1, 0]], 
  RowBox[{"(*", 
   RowBox[{"um", "-", 
    RowBox[{"scanned", " ", "area"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"dim", "=", "256"}], ";"}],
   Background->RGBColor[1, 1, 0]], 
  RowBox[{"(*", 
   RowBox[{"sample", " ", "per", " ", "line"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nx", "=", "dim"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ny", "=", "dim"}], ";"}]}], "Input",
 CellChangeTimes->{{3.825287576875769*^9, 3.825287622395018*^9}, {
   3.82637561352851*^9, 3.826375634848108*^9}, 3.82655870112401*^9, {
   3.8325586359760785`*^9, 3.8325586679803057`*^9}, {3.83255872455982*^9, 
   3.832558727940271*^9}, {3.8325588300389814`*^9, 3.8325588301567993`*^9}, {
   3.8325588955112705`*^9, 3.8325588997088423`*^9}, {3.832558969588098*^9, 
   3.832558969766432*^9}, {3.8325590581727424`*^9, 3.832559071611576*^9}, {
   3.832563704201264*^9, 3.8325637586905565`*^9}, {3.83256396366051*^9, 
   3.8325639639939146`*^9}, {3.8325647195144873`*^9, 3.832564722185485*^9}, {
   3.83256476929212*^9, 3.8325648295137854`*^9}, {3.8326363017535596`*^9, 
   3.8326363133615217`*^9}, {3.863531147781253*^9, 3.8635311737236567`*^9}, {
   3.863531617516608*^9, 3.8635316811471615`*^9}, {3.8635321062989025`*^9, 
   3.863532113842704*^9}, {3.917665452288062*^9, 3.9176654571847277`*^9}, {
   3.929223566105331*^9, 3.929223566849639*^9}, {3.929223723017015*^9, 
   3.929223779038847*^9}, {3.929224342566889*^9, 3.929224376744298*^9}, 
   3.929225603031465*^9, {3.929269104951919*^9, 3.929269140891426*^9}, {
   3.92926959714867*^9, 3.929269598681072*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[188]:=",ExpressionUUID->"ee55da98-7a6a-4472-b4f3-e5755e44b95b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Data import", "Subsubsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}, {3.929269784461997*^9, 
  3.9292697870709343`*^9}},ExpressionUUID->"0931a4bd-b3f9-4245-8cea-\
16fbb8c070e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"allFiles", "=", 
    RowBox[{"FileNames", "[", 
     RowBox[{"\"\<*.txt\>\"", ",", 
      StyleBox["\"\<sample data\>\"",
       Background->RGBColor[1, 1, 0]]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"import", " ", ".", "txt"}], " ", "files", " ", "in", " ", "the", 
    " ", "directory", " ", 
    RowBox[{"name", " ", "'"}], 
    RowBox[{"data", "'"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"allData", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"#", ",", "\"\<Data\>\""}], "]"}], "&"}], "/@", "allFiles"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"allData", "//", "Dimensions", 
  RowBox[{"(*", 
   RowBox[{"Check", " ", "how", " ", 
    RowBox[{"many", " ", ".", "txt"}], " ", "files", " ", "were", " ", 
    "imported"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8232611717253447`*^9, 3.8232612154924126`*^9}, {
   3.8232614577234173`*^9, 3.8232614631329517`*^9}, {3.8232649068344803`*^9, 
   3.82326491236569*^9}, {3.82330119766807*^9, 3.8233012019070272`*^9}, {
   3.8233469056160164`*^9, 3.8233469412433767`*^9}, {3.8233470478788333`*^9, 
   3.8233470649928637`*^9}, {3.823349124876257*^9, 3.8233491275273037`*^9}, {
   3.823353545626013*^9, 3.8233535466609497`*^9}, 3.8238230185035973`*^9, 
   3.831810310922167*^9, {3.8635279090413685`*^9, 3.8635279164151154`*^9}, {
   3.863529305432933*^9, 3.863529307478408*^9}, {3.863529708437172*^9, 
   3.863529741810153*^9}, 3.864218512779066*^9, {3.8800564237888317`*^9, 
   3.880056423957943*^9}, 3.8800564798420153`*^9, {3.9176638892886477`*^9, 
   3.917663896647574*^9}, {3.9176639658433113`*^9, 3.917663966614032*^9}, {
   3.917664468756398*^9, 3.917664469730792*^9}, {3.929219649576461*^9, 
   3.929219662045147*^9}, {3.929268915429681*^9, 3.929268957320817*^9}, {
   3.92926958444038*^9, 3.929269588701434*^9}, {3.929274081531149*^9, 
   3.9292740832164793`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[193]:=",ExpressionUUID->"01594611-c8bd-4041-bfc7-301d5d8aa2c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "65537", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9292699429892263`*^9, 3.92927136658635*^9, 3.929272024893425*^9, {
   3.9292722612777357`*^9, 3.929272266977174*^9}, 3.929272300449333*^9, 
   3.929272595706214*^9, 3.929273124858563*^9, 3.929273423312829*^9, 
   3.929274101903988*^9, 3.929274310327305*^9, 3.929274895139062*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"107f0740-3683-4a64-89da-d28baac2055e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"allData2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "allData", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "allData", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    StyleBox[
     RowBox[{
      RowBox[{"allData2", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"allData", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}]}],
     Background->RGBColor[1, 1, 0]], 
    StyleBox[";",
     Background->RGBColor[1, 1, 0]], 
    RowBox[{"(*", 
     RowBox[{"Drop", " ", "the", " ", "first", " ", "line", " ", 
      RowBox[{"(", "names", ")"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"i", "++"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allData", "//", "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{"allData2", "//", "Dimensions"}]}], "Input",
 CellChangeTimes->{{3.8635295455969224`*^9, 3.863529567236394*^9}, {
  3.8635298689112525`*^9, 3.8635298718458014`*^9}, {3.8635300495009127`*^9, 
  3.863530101906109*^9}, {3.8635301611671915`*^9, 3.863530167237778*^9}, {
  3.8635331025151896`*^9, 3.8635331102845707`*^9}, {3.929219803781536*^9, 
  3.9292198627907*^9}, {3.929220336203712*^9, 3.9292203505679817`*^9}, {
  3.929220524635066*^9, 3.929220533765347*^9}, {3.929222123006044*^9, 
  3.929222139278789*^9}, {3.9292221912854013`*^9, 3.929222197357527*^9}, {
  3.9292690746804113`*^9, 3.929269089377405*^9}, {3.9292696161667423`*^9, 
  3.9292696273683853`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[196]:=",ExpressionUUID->"8f5a32e2-e64a-4680-a1b0-43cb1d12200d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "65537", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.929222198809304*^9, 3.929223210353445*^9, 3.9292646684005632`*^9, 
   3.9292687791079407`*^9, 3.929269943037161*^9, 3.929271366638605*^9, 
   3.9292720249040947`*^9, {3.9292722612947607`*^9, 3.9292722669858932`*^9}, 
   3.92927230048879*^9, 3.929272595764567*^9, 3.929273124902762*^9, 
   3.9292734233536253`*^9, 3.929274101944372*^9, 3.929274310363757*^9, 
   3.92927489517496*^9},
 CellLabel->
  "Out[198]=",ExpressionUUID->"31ec87ec-1f99-4dcd-a570-3fefe2a3e6ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "65536", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.929222198809304*^9, 3.929223210353445*^9, 3.9292646684005632`*^9, 
   3.9292687791079407`*^9, 3.929269943037161*^9, 3.929271366638605*^9, 
   3.9292720249040947`*^9, {3.9292722612947607`*^9, 3.9292722669858932`*^9}, 
   3.92927230048879*^9, 3.929272595764567*^9, 3.929273124902762*^9, 
   3.9292734233536253`*^9, 3.929274101944372*^9, 3.929274310363757*^9, 
   3.929274895180953*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"1b49c203-f506-4e45-ab0d-206f165403e7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Data rearrangement", "Subsubsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}, {3.929269784461997*^9, 
  3.9292698012096243`*^9}},ExpressionUUID->"30937d13-9c31-4708-828d-\
4a803204a035"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nDatasets", "=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "allData2", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Dimension", " ", "of", " ", "the", " ", "square", " ", "array"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "nDatasets", "}"}], ",", 
      RowBox[{"{", "dim", "}"}], ",", 
      RowBox[{"{", "dim", "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Initialize", " ", "an", " ", "empty", " ", "list", " ", 
    RowBox[{"(", "e", ")"}], " ", "to", " ", "hold", " ", "all", " ", 
    "reshaped", " ", "datasets"}], "*)"}]}], "\n", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"p", "=", "1"}], ",", 
   RowBox[{"p", "<=", "nDatasets"}], ",", 
   RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", "dim"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", "dim"}], ",", 
       RowBox[{"j", "++"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "the", " ", "linear", " ", "index"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"linearIndex", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "dim"}], "+", "j"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Assign", " ", "the", " ", "value", " ", "from", " ", "allData2", 
          " ", "to", " ", "the", " ", "new", " ", "array"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"e", "[", 
          RowBox[{"[", 
           RowBox[{"p", ",", "i", ",", "j"}], "]"}], "]"}], "=", 
         RowBox[{"allData2", "[", 
          RowBox[{"[", 
           RowBox[{"p", ",", "linearIndex", ",", "1"}], "]"}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"e", "//", "Dimensions"}]}], "Input",
 CellChangeTimes->{{3.8635302125611696`*^9, 3.8635302729253893`*^9}, {
   3.8635331362909737`*^9, 3.8635331423780394`*^9}, {3.9176651294159107`*^9, 
   3.917665174264529*^9}, {3.917665852741249*^9, 3.9176658528225307`*^9}, 
   3.929223256154469*^9, {3.9292234110358143`*^9, 3.929223412740015*^9}, {
   3.929269028872896*^9, 3.929269029760936*^9}, {3.9292692211518593`*^9, 
   3.929269239586342*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[200]:=",ExpressionUUID->"3f3f7581-443a-438f-ad1c-0f095292663d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "256", ",", "256"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9292234141673603`*^9, 3.929264669466627*^9, 3.929268780176167*^9, 
   3.929269282581293*^9, 3.929269944165998*^9, 3.929271366649206*^9, 
   3.9292720249222527`*^9, {3.929272261303143*^9, 3.9292722670116997`*^9}, 
   3.929272301606431*^9, 3.92927259686729*^9, 3.929273126004855*^9, 
   3.929273425216031*^9, 3.929274103023196*^9, 3.929274311479022*^9, 
   3.9292748958220043`*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"01e40ffc-2728-4622-a561-11c57b8c4713"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Data name assignment", "Subsubsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}, {3.929269784461997*^9, 
  3.929269816229926*^9}},ExpressionUUID->"ac0370a3-ea1a-4743-b4c9-\
39e083426586"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "name", " ", "each", " ", "dataset", " ", "for", " ", "convenience"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IR1034", "=", 
     RowBox[{"e", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IR1060", "=", 
     RowBox[{"e", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IR1150", "=", 
     RowBox[{"e", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rIR1034", "=", 
     RowBox[{"e", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rIR1060", "=", 
     RowBox[{"e", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rIR1150", "=", 
     RowBox[{"e", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9292234471399612`*^9, 3.929223539470096*^9}, {
  3.929225952511407*^9, 3.929225958598192*^9}, {3.929269269216775*^9, 
  3.92926929775776*^9}, {3.9292748265111103`*^9, 3.929274838943433*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[204]:=",ExpressionUUID->"8ca1bd45-fd6e-4d8b-80f0-af8b00c80fde"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["b. Normalization - Ratio map",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}, {3.929269784461997*^9, 3.929269827235845*^9}, {
  3.9292705218838787`*^9, 
  3.929270530505988*^9}},ExpressionUUID->"1841d59b-f6ac-4b29-a445-\
1dbcbd22ae45"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"cut1", "=", "0"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"cut", " ", "out", " ", "outliers"}], "*)"}]}],
  FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"cut2", "=", "10"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"cut", " ", "out", " ", "outliers"}], "*)"}]}],
  FontColor->RGBColor[1, 0, 0]]}], "Input",
 CellChangeTimes->{{3.9292234471399612`*^9, 3.929223539470096*^9}, {
   3.929225952511407*^9, 3.929225958598192*^9}, {3.929269269216775*^9, 
   3.92926929775776*^9}, 3.92926966155687*^9, {3.929270641720067*^9, 
   3.92927067860433*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[210]:=",ExpressionUUID->"1f37a341-142e-4c46-9f74-9109740740b0"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "Which", " ", "one", " ", "do", " ", "you", " ", "want", " ", "to", " ", 
     RowBox[{"normalize", "?", " ", "\[IndentingNewLine]", "Correct"}], " ", 
     "the", " ", "yellow", " ", "highlights", " ", "manually"}], "*)"}],
   FontColor->RGBColor[1, 0, 0],
   Background->RGBColor[1, 1, 0]], 
  StyleBox["\[IndentingNewLine]",
   FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IR1060n", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", "dim"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", "dim"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"cut1", "<", 
            RowBox[{
             RowBox[{"IR1060", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{
              StyleBox["IR1034",
               Background->RGBColor[1, 1, 0]], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "<", "cut2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"IR1060n", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"IR1060", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
              RowBox[{
               StyleBox["IR1034",
                Background->RGBColor[1, 1, 0]], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", "++"}]}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IR1150n", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", "dim"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", "dim"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"cut1", "<", 
            RowBox[{
             RowBox[{"IR1150", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{
              StyleBox["IR1034",
               Background->RGBColor[1, 1, 0]], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "<", "cut2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"IR1150n", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"IR1150", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
              RowBox[{
               StyleBox["IR1034",
                Background->RGBColor[1, 1, 0]], "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", "++"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8635295455969224`*^9, 3.863529567236394*^9}, {
   3.8635298689112525`*^9, 3.8635298718458014`*^9}, {3.8635300495009127`*^9, 
   3.863530101906109*^9}, {3.8635301611671915`*^9, 3.863530167237778*^9}, {
   3.863530652517416*^9, 3.8635307167399683`*^9}, {3.8635307555851855`*^9, 
   3.8635308497169003`*^9}, {3.86353295771672*^9, 3.8635329811469746`*^9}, {
   3.917665041874988*^9, 3.9176650424103622`*^9}, {3.9176651883891697`*^9, 
   3.917665200364767*^9}, {3.929225732239764*^9, 3.929226009224081*^9}, {
   3.92922637604463*^9, 3.929226429739957*^9}, {3.9292270537173223`*^9, 
   3.929227058808167*^9}, {3.929227245349862*^9, 3.929227296033557*^9}, {
   3.9292273308378897`*^9, 3.929227343246542*^9}, {3.929227415672076*^9, 
   3.929227429286837*^9}, {3.929227512355393*^9, 3.929227513983655*^9}, 
   3.9292281754020147`*^9, {3.929228280478133*^9, 3.929228280574339*^9}, {
   3.9292693203513613`*^9, 3.9292693429381647`*^9}, 3.929269652776876*^9, {
   3.929269723236814*^9, 3.9292697234189796`*^9}, {3.929270555938401*^9, 
   3.9292705793451567`*^9}, {3.9292706585715714`*^9, 3.929270695838098*^9}, {
   3.929274854117612*^9, 3.92927486077349*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[212]:=",ExpressionUUID->"95277a3a-94b1-4817-abc5-7defddee11af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rIR1060n", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", "dim"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", "dim"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"cut1", "<", 
           RowBox[{
            RowBox[{"rIR1060", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
            RowBox[{
             StyleBox["rIR1034",
              Background->RGBColor[1, 1, 0]], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "<", "cut2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rIR1060n", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"rIR1060", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
            RowBox[{
             StyleBox["rIR1034",
              Background->RGBColor[1, 1, 0]], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "++"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rIR1150n", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", "dim"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "<=", "dim"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cut1", "<", 
          RowBox[{
           RowBox[{"rIR1150", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
           RowBox[{
            StyleBox["rIR1034",
             Background->RGBColor[1, 1, 0]], "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "<", "cut2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"rIR1150n", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"rIR1150", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
            RowBox[{
             StyleBox["rIR1034",
              Background->RGBColor[1, 1, 0]], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"i", "++"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8635295455969224`*^9, 3.863529567236394*^9}, {
  3.8635298689112525`*^9, 3.8635298718458014`*^9}, {3.8635300495009127`*^9, 
  3.863530101906109*^9}, {3.8635301611671915`*^9, 3.863530167237778*^9}, {
  3.863530652517416*^9, 3.8635307167399683`*^9}, {3.8635307555851855`*^9, 
  3.8635308497169003`*^9}, {3.86353295771672*^9, 3.8635329811469746`*^9}, {
  3.917665041874988*^9, 3.9176650424103622`*^9}, {3.9176651883891697`*^9, 
  3.917665200364767*^9}, {3.929225732239764*^9, 3.929226009224081*^9}, {
  3.92922604611942*^9, 3.9292260671612797`*^9}, {3.9292262011179857`*^9, 
  3.9292263196149054`*^9}, {3.9292270618596573`*^9, 3.9292270665610123`*^9}, {
  3.929227282007573*^9, 3.929227302818027*^9}, {3.9292273798078947`*^9, 
  3.929227391378265*^9}, {3.9292705813738003`*^9, 3.9292706001545973`*^9}, {
  3.9292748640385647`*^9, 3.929274864973721*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[216]:=",ExpressionUUID->"c2cd273b-0975-48fe-af0b-1a73c86f3a08"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["c. Imaging",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.929269752906913*^9, 3.929269761786269*^9}, {
  3.929269841966441*^9, 3.929269848876638*^9}, {3.929270536040066*^9, 
  3.9292705361413603`*^9}},ExpressionUUID->"0144e3dd-e075-4a09-b046-\
9a3a24686c40"],

Cell[CellGroupData[{

Cell["0. inputs", "Subsubsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}, {3.929269784461997*^9, 3.929269827235845*^9}, {
  3.929269865753056*^9, 
  3.9292698781822863`*^9}},ExpressionUUID->"44104915-8130-4444-820d-\
a07ad423d91e"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"d", "=", "0.5"}], ";"}],
    Background->RGBColor[1, 1, 0]], 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{"Choose", " ", "the", " ", "tip", " ", "distance"}], "*)"}],
    Background->RGBColor[1, 1, 0]], "\[IndentingNewLine]"}],
  FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tickX", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dim", "/", "Lx"}], ")"}], "i"}], ",", "i"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "Lx", ",", "d"}], "}"}]}], "]"}], ",", 
     "0.001"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tickY", "=", 
   RowBox[{"Round", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dim", "/", "Ly"}], ")"}], "i"}], ",", "i"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "Ly", ",", "d"}], "}"}]}], "]"}], ",", 
     "0.001"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"nx", ">=", "ny"}], ",", 
    RowBox[{"imgSize", "=", "500"}], ",", 
    RowBox[{"imgSize", "=", "300"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"nx", ">=", "ny"}], ",", 
    RowBox[{"legSize", "=", "220"}], ",", 
    RowBox[{"legSize", "=", "440"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.825287576875769*^9, 3.825287622395018*^9}, {
   3.82637561352851*^9, 3.826375634848108*^9}, 3.82655870112401*^9, {
   3.8325586359760785`*^9, 3.8325586679803057`*^9}, {3.83255872455982*^9, 
   3.832558727940271*^9}, {3.8325588300389814`*^9, 3.8325588301567993`*^9}, {
   3.8325588955112705`*^9, 3.8325588997088423`*^9}, {3.832558969588098*^9, 
   3.832558969766432*^9}, {3.8325590581727424`*^9, 3.832559071611576*^9}, {
   3.832563704201264*^9, 3.8325637586905565`*^9}, {3.83256396366051*^9, 
   3.8325639639939146`*^9}, {3.8325647195144873`*^9, 3.832564722185485*^9}, {
   3.83256476929212*^9, 3.8325648295137854`*^9}, {3.8326363017535596`*^9, 
   3.8326363133615217`*^9}, {3.863531594062289*^9, 3.863531599468781*^9}, {
   3.863532098014547*^9, 3.863532160453257*^9}, {3.863532217207134*^9, 
   3.8635322383399205`*^9}, {3.863532333233919*^9, 3.863532384114669*^9}, {
   3.863532423970599*^9, 3.8635324367805233`*^9}, {3.863532471805151*^9, 
   3.8635325614823427`*^9}, {3.863533711666778*^9, 3.8635337636545677`*^9}, {
   3.863533800869847*^9, 3.8635338206258645`*^9}, {3.929223943840211*^9, 
   3.929224082853997*^9}, {3.929224491391683*^9, 3.929224499334237*^9}, 
   3.929224987695665*^9, {3.929225020472185*^9, 3.929225174862857*^9}, {
   3.929225312266324*^9, 3.929225354745706*^9}, {3.929225394917925*^9, 
   3.929225411645585*^9}, {3.929225466549202*^9, 3.929225471688126*^9}, {
   3.92922550592445*^9, 3.929225548399836*^9}, {3.92922557925287*^9, 
   3.929225581710958*^9}, {3.92922561735715*^9, 3.9292256333315372`*^9}, 
   3.929264705323539*^9, {3.929265841982545*^9, 3.929265842889991*^9}, {
   3.929269383998022*^9, 3.929269402275238*^9}, {3.9292701341867313`*^9, 
   3.9292701347604647`*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[220]:=",ExpressionUUID->"d89a54b3-a7d8-4a28-9c3d-e617384b1c50"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Define function - IRmap", "Subsubsection",
 CellChangeTimes->{{3.863529905495795*^9, 3.863529918434486*^9}, {
  3.9292695770200977`*^9, 3.929269578770183*^9}, {3.929269681644449*^9, 
  3.9292696848549833`*^9}, {3.929269784461997*^9, 3.929269827235845*^9}, {
  3.929269865753056*^9, 
  3.929269895070332*^9}},ExpressionUUID->"c718ecbd-e2cf-4810-8ffd-\
7cc50e449194"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"IRmap", ",", "IRmap2"}], "]"}]], "Input",
 CellChangeTimes->{{3.929271935935512*^9, 3.9292719429596643`*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"03be7f3a-6dae-4b77-82f3-bd78875ae95f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Unnormalized", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"IRmap", ",", "HoldFirst"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"IRmap", "[", 
     RowBox[{"temp_", ",", "cont_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "name1", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"name1", "=", 
        RowBox[{"SymbolName", "[", 
         RowBox[{"Unevaluated", "[", "temp", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListContourPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "temp", "]"}], ",", 
         RowBox[{"PlotRange", "->", "All"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"ImageSize", "->", "imgSize"}], ",", 
         RowBox[{"LabelStyle", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "->", "\"\<Arial\>\""}], ",", 
            RowBox[{"FontSize", "->", "16"}], ",", "Black"}], "}"}]}], ",", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
         RowBox[{"FrameTicks", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tickX", ",", "tickY"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"tickX", ",", "tickY"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "->", 
          RowBox[{"ny", "/", "nx"}]}], ",", 
         RowBox[{"ColorFunction", "->", "\"\<Rainbow\>\""}], ",", 
         RowBox[{"Contours", "->", "cont"}], ",", 
         RowBox[{"ContourStyle", "->", "None"}], ",", 
         RowBox[{"GridLines", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "nx", ",", 
              RowBox[{
               RowBox[{"dim", "/", "Lx"}], "*", "d"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "ny", ",", 
              RowBox[{
               RowBox[{"dim", "/", "Ly"}], "*", "d"}]}], "]"}]}], "}"}]}], 
         ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<GridLinesInFront\>\"", "->", "True"}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"BarLegend", "[", 
             RowBox[{"Automatic", ",", 
              RowBox[{"LegendMarkerSize", "->", "legSize"}], ",", 
              RowBox[{"LegendLabel", "->", "\"\<Intensity\>\""}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"After", ",", "Top"}], "}"}]}], "]"}]}], ",", 
         StyleBox[
          RowBox[{"PlotLabel", "->", 
           RowBox[{"Dynamic", 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            StyleBox["name1",
             FontColor->GrayLevel[0]], 
            StyleBox["]",
             FontColor->GrayLevel[0]]}]}],
          FontSize->14]}], "]"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.825287576875769*^9, 3.825287622395018*^9}, {
   3.82637561352851*^9, 3.826375634848108*^9}, 3.82655870112401*^9, {
   3.8325586359760785`*^9, 3.8325586679803057`*^9}, {3.83255872455982*^9, 
   3.832558727940271*^9}, {3.8325588300389814`*^9, 3.8325588301567993`*^9}, {
   3.8325588955112705`*^9, 3.8325588997088423`*^9}, {3.832558969588098*^9, 
   3.832558969766432*^9}, {3.8325590581727424`*^9, 3.832559071611576*^9}, {
   3.832563704201264*^9, 3.8325637586905565`*^9}, {3.83256396366051*^9, 
   3.8325639639939146`*^9}, {3.8325647195144873`*^9, 3.832564722185485*^9}, {
   3.83256476929212*^9, 3.8325648295137854`*^9}, {3.8326363017535596`*^9, 
   3.8326363133615217`*^9}, {3.863531594062289*^9, 3.863531599468781*^9}, {
   3.863532098014547*^9, 3.863532160453257*^9}, {3.863532217207134*^9, 
   3.8635322383399205`*^9}, {3.863532333233919*^9, 3.863532384114669*^9}, {
   3.863532423970599*^9, 3.8635324367805233`*^9}, {3.863532471805151*^9, 
   3.8635325614823427`*^9}, {3.863533711666778*^9, 3.8635337636545677`*^9}, {
   3.863533800869847*^9, 3.8635338206258645`*^9}, {3.929223943840211*^9, 
   3.929224082853997*^9}, {3.929224491391683*^9, 3.929224499334237*^9}, {
   3.929224530519999*^9, 3.92922453625788*^9}, {3.929224796941802*^9, 
   3.9292248521539707`*^9}, {3.929225191795946*^9, 3.929225193185162*^9}, {
   3.9292254272137337`*^9, 3.929225437268008*^9}, 3.929225589968638*^9, {
   3.929226770550702*^9, 3.929226837255433*^9}, {3.929227078461235*^9, 
   3.9292270785308657`*^9}, {3.929265787813141*^9, 3.9292658089159527`*^9}, {
   3.929265850230853*^9, 3.929265867806767*^9}, {3.9292660698913393`*^9, 
   3.9292660956493893`*^9}, {3.9292685540367613`*^9, 3.9292685685377693`*^9}, 
   3.929268800951584*^9, {3.929270817052451*^9, 3.929270881025619*^9}, {
   3.92927094596776*^9, 3.929270950455812*^9}, {3.9292709815434437`*^9, 
   3.929270983849695*^9}, {3.9292710368770742`*^9, 3.9292710399747868`*^9}, {
   3.929271078366026*^9, 3.929271079987323*^9}, {3.929271114595605*^9, 
   3.9292711220175657`*^9}, {3.929271550757799*^9, 3.9292715615641527`*^9}, {
   3.9292716927599373`*^9, 3.929271703950492*^9}, {3.929271790200734*^9, 
   3.929271798662305*^9}, {3.929271903415477*^9, 3.929271926196982*^9}, {
   3.929271956601053*^9, 3.9292719771435843`*^9}, {3.9292720118073273`*^9, 
   3.9292720128395*^9}, {3.929272568318654*^9, 3.9292725827498426`*^9}, {
   3.92927288339992*^9, 3.929272923375531*^9}, {3.929272968306159*^9, 
   3.929272968910801*^9}, 3.929273085078931*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[226]:=",ExpressionUUID->"559ac612-4dcf-4544-acb6-fd4285bf1d86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Normalized", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"IRmap2", ",", "HoldFirst"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IRmap2", "[", 
     RowBox[{"temp_", ",", "max_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "name2", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"name2", "=", 
        RowBox[{"SymbolName", "[", 
         RowBox[{"Unevaluated", "[", "temp", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"leg", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "max", ",", 
            RowBox[{"max", "/", "dd"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListContourPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "temp", "]"}], ",", 
         StyleBox[
          RowBox[{"PlotRange", "\[Rule]", "All"}],
          Background->RGBColor[0.88, 1, 0.88]], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imgSize"}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", " ", 
            RowBox[{"FontSize", "\[Rule]", "16"}], ",", "Black"}], "}"}]}], 
         ",", 
         StyleBox[
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}],
          FontSize->14], 
         StyleBox[",",
          FontSize->14], 
         StyleBox[
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tickX", ",", "tickY"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"tickX", ",", "tickY"}], "}"}]}], "}"}]}],
          FontSize->14], 
         StyleBox[",",
          FontSize->14], 
         RowBox[{
          StyleBox["AspectRatio",
           FontSize->14], 
          StyleBox["\[Rule]",
           FontSize->14], 
          FractionBox["ny", "nx"]}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
         RowBox[{"Contours", "\[Rule]", "leg"}], ",", 
         RowBox[{"ContourStyle", "\[Rule]", "None"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "nx", ",", 
              RowBox[{
               RowBox[{"dim", "/", "Lx"}], "*", "d"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "ny", ",", 
              RowBox[{
               RowBox[{"dim", "/", "Ly"}], "*", "d"}]}], "]"}]}], "}"}]}], 
         ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<GridLinesInFront\>\"", "\[Rule]", "True"}], "}"}]}], 
         ",", " ", 
         RowBox[{"PlotLegends", "\[Rule]", 
          StyleBox[
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"BarLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<Rainbow\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "max"}], "}"}]}], "}"}], ",", 
               RowBox[{"LegendMarkerSize", "\[Rule]", "legSize"}], ",", 
               RowBox[{"LegendLabel", "\[Rule]", "\"\<Intensity\>\""}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"After", ",", "Top"}], "}"}]}], "]"}],
           FontSize->14]}], 
         StyleBox[",",
          FontSize->14], 
         StyleBox[
          RowBox[{"PlotLabel", "->", 
           RowBox[{"Dynamic", 
            StyleBox["[",
             FontColor->GrayLevel[0]], 
            StyleBox["name2",
             FontColor->GrayLevel[0]], 
            StyleBox["]",
             FontColor->GrayLevel[0]]}]}],
          FontSize->14]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.825287576875769*^9, 3.825287622395018*^9}, {
   3.82637561352851*^9, 3.826375634848108*^9}, 3.82655870112401*^9, {
   3.8325586359760785`*^9, 3.8325586679803057`*^9}, {3.83255872455982*^9, 
   3.832558727940271*^9}, {3.8325588300389814`*^9, 3.8325588301567993`*^9}, {
   3.8325588955112705`*^9, 3.8325588997088423`*^9}, {3.832558969588098*^9, 
   3.832558969766432*^9}, {3.8325590581727424`*^9, 3.832559071611576*^9}, {
   3.832563704201264*^9, 3.8325637586905565`*^9}, {3.83256396366051*^9, 
   3.8325639639939146`*^9}, {3.8325647195144873`*^9, 3.832564722185485*^9}, {
   3.83256476929212*^9, 3.8325648295137854`*^9}, {3.8326363017535596`*^9, 
   3.8326363133615217`*^9}, {3.863531594062289*^9, 3.863531599468781*^9}, {
   3.863532098014547*^9, 3.863532160453257*^9}, {3.863532217207134*^9, 
   3.8635322383399205`*^9}, {3.863532333233919*^9, 3.863532384114669*^9}, {
   3.863532423970599*^9, 3.8635324367805233`*^9}, {3.863532471805151*^9, 
   3.8635325614823427`*^9}, {3.863533711666778*^9, 3.8635337636545677`*^9}, {
   3.863533800869847*^9, 3.8635338206258645`*^9}, {3.929223943840211*^9, 
   3.929224082853997*^9}, {3.929224491391683*^9, 3.929224499334237*^9}, {
   3.929224530519999*^9, 3.92922453625788*^9}, {3.929224796941802*^9, 
   3.9292248521539707`*^9}, {3.929225191795946*^9, 3.929225193185162*^9}, {
   3.9292254272137337`*^9, 3.929225437268008*^9}, 3.929225589968638*^9, {
   3.929226770550702*^9, 3.929226837255433*^9}, {3.929227078461235*^9, 
   3.9292270785308657`*^9}, {3.929265787813141*^9, 3.9292658089159527`*^9}, {
   3.929265850230853*^9, 3.929265867806767*^9}, {3.9292660698913393`*^9, 
   3.9292660956493893`*^9}, {3.9292685540367613`*^9, 3.9292685685377693`*^9}, 
   3.929268800951584*^9, {3.929270817052451*^9, 3.929270819820266*^9}, {
   3.9292710818022547`*^9, 3.929271083361545*^9}, {3.929271125442898*^9, 
   3.9292711285290833`*^9}, {3.92927157759508*^9, 3.9292715932263613`*^9}, 
   3.929271711168981*^9, {3.9292721557828712`*^9, 3.929272156855997*^9}, {
   3.929272205122307*^9, 3.9292722080085382`*^9}, {3.9292725580648613`*^9, 
   3.929272561416678*^9}, {3.929273160711149*^9, 3.929273175771452*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[228]:=",ExpressionUUID->"b83d350d-b075-403e-b02c-9f33cc86cb41"],

Cell[BoxData[
 RowBox[{"IRmap", "[", 
  RowBox[{"IR1060", ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.929272045842355*^9, 3.9292720526245623`*^9}, {
  3.929272108977304*^9, 3.9292721123286543`*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"b15281b5-bc91-41ff-ae5b-f0ff6c5e671c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["d. Here we go",
 FontWeight->"Bold"]], "Subsection",
 CellChangeTimes->{{3.929269752906913*^9, 3.929269761786269*^9}, {
   3.929269841966441*^9, 3.929269848876638*^9}, {3.9292699118416977`*^9, 
   3.9292699149784727`*^9}, 
   3.929270538371833*^9},ExpressionUUID->"8c824cc9-4e9a-4e2f-b460-\
bfa5b4fe890a"],

Cell[BoxData[
 RowBox[{"(*", "    ", 
  RowBox[{"IR1034", ";", "IR1060", ";", "IR1150", ";", "IR1166a", ";", 
   RowBox[{"IR1166b", " ", ";;"}], ";", " ", "rIR1034", ";", "rIR1060", ";", 
   "rIR1150", ";", "rIR1166a", ";", "rIR1166b"}], "      ", "*)"}]], "Input",
 CellChangeTimes->{{3.929226596488265*^9, 3.9292266435729303`*^9}, 
   3.929227722010827*^9, {3.929266455213932*^9, 3.929266461332032*^9}, {
   3.929269918995659*^9, 3.9292699214226227`*^9}, {3.929273204202548*^9, 
   3.92927320778388*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"1661bccc-9935-41f8-bc61-05a95a83c1df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"IRmap", "[", 
     RowBox[{"IR1060", ",", "20"}], "]"}], ",", 
    RowBox[{"IRmap", "[", 
     RowBox[{"IR1034", ",", "20"}], "]"}]}], "}"}], 
  RowBox[{"(*", 
   RowBox[{"wvn", ",", " ", 
    RowBox[{"#", " ", "of", " ", "countour", " ", "line"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.929270778337789*^9, 3.929270802043296*^9}, {
   3.929271151183886*^9, 3.929271276403908*^9}, 3.9292726189155684`*^9, {
   3.929274117507728*^9, 3.929274120834543*^9}, {3.9292748736946373`*^9, 
   3.929274879201562*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"903cda10-ceff-421b-ad66-de44020b0004"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IRmap2", "[", 
   RowBox[{"IR1060n", ",", "1.5", ",", "20"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"wvn", ",", "max", ",", "bin"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.929273236133081*^9, 3.92927324438288*^9}, {
  3.9292732781772327`*^9, 3.929273297166649*^9}, {3.929273327974226*^9, 
  3.929273328153605*^9}, {3.929274132505314*^9, 3.929274134916403*^9}, {
  3.929274882088025*^9, 3.929274886019375*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"d3ab5d75-8719-4946-a1fe-967ec710df5e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 779},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f936a801-23f5-4937-b95a-f2cac231e983"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 241, 4, 67, "Section",ExpressionUUID->"42dd79a8-9e1a-4531-a964-7af2f58b26f6"],
Cell[CellGroupData[{
Cell[846, 30, 583, 13, 73, "Input",ExpressionUUID->"423c22fd-5ae2-41cd-8e14-d2d388ab648f"],
Cell[1432, 45, 563, 9, 34, "Output",ExpressionUUID->"c4560d50-35a9-46f3-ac83-ea3c82f505b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2032, 59, 215, 4, 54, "Subsection",ExpressionUUID->"30c63f09-c0ac-4c05-a2b2-d6085e53c6de"],
Cell[CellGroupData[{
Cell[2272, 67, 269, 4, 45, "Subsubsection",ExpressionUUID->"1cbcbd63-82e0-4d65-8ad0-0b586ceb661b"],
Cell[2544, 73, 2095, 47, 131, "Input",ExpressionUUID->"ee55da98-7a6a-4472-b4f3-e5755e44b95b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4676, 125, 315, 5, 45, "Subsubsection",ExpressionUUID->"0931a4bd-b3f9-4245-8cea-16fbb8c070e8"],
Cell[CellGroupData[{
Cell[5016, 134, 2048, 43, 89, "Input",ExpressionUUID->"01594611-c8bd-4041-bfc7-301d5d8aa2c3"],
Cell[7067, 179, 474, 9, 34, "Output",ExpressionUUID->"107f0740-3683-4a64-89da-d28baac2055e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7578, 193, 1846, 43, 152, "Input",ExpressionUUID->"8f5a32e2-e64a-4680-a1b0-43cb1d12200d"],
Cell[9427, 238, 577, 11, 34, "Output",ExpressionUUID->"31ec87ec-1f99-4dcd-a570-3fefe2a3e6ae"],
Cell[10007, 251, 578, 11, 34, "Output",ExpressionUUID->"1b49c203-f506-4e45-ab0d-206f165403e7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10634, 268, 322, 5, 45, "Subsubsection",ExpressionUUID->"30937d13-9c31-4708-828d-4a803204a035"],
Cell[CellGroupData[{
Cell[10981, 277, 2743, 69, 257, "Input",ExpressionUUID->"3f3f7581-443a-438f-ad1c-0f095292663d"],
Cell[13727, 348, 574, 11, 34, "Output",ExpressionUUID->"01e40ffc-2728-4622-a561-11c57b8c4713"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14350, 365, 322, 5, 45, "Subsubsection",ExpressionUUID->"ac0370a3-ea1a-4743-b4c9-39e083426586"],
Cell[14675, 372, 1334, 37, 194, "Input",ExpressionUUID->"8ca1bd45-fd6e-4d8b-80f0-af8b00c80fde"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[16058, 415, 416, 7, 38, "Subsection",ExpressionUUID->"1841d59b-f6ac-4b29-a445-1dbcbd22ae45"],
Cell[16477, 424, 775, 21, 68, "Input",ExpressionUUID->"1f37a341-142e-4c46-9f74-9109740740b0"],
Cell[17255, 447, 5390, 130, 446, "Input",ExpressionUUID->"95277a3a-94b1-4817-abc5-7defddee11af"],
Cell[22648, 579, 4466, 114, 383, "Input",ExpressionUUID->"c2cd273b-0975-48fe-af0b-1a73c86f3a08"]
}, Closed]],
Cell[CellGroupData[{
Cell[27151, 698, 296, 5, 38, "Subsection",ExpressionUUID->"0144e3dd-e075-4a09-b046-9a3a24686c40"],
Cell[CellGroupData[{
Cell[27472, 707, 359, 6, 45, "Subsubsection",ExpressionUUID->"44104915-8130-4444-820d-a07ad423d91e"],
Cell[27834, 715, 3462, 78, 152, "Input",ExpressionUUID->"d89a54b3-a7d8-4a28-9c3d-e617384b1c50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31333, 798, 374, 6, 45, "Subsubsection",ExpressionUUID->"c718ecbd-e2cf-4810-8ffd-7cc50e449194"],
Cell[31710, 806, 244, 5, 30, "Input",ExpressionUUID->"03be7f3a-6dae-4b77-82f3-bd78875ae95f"],
Cell[31957, 813, 5713, 115, 200, "Input",ExpressionUUID->"559ac612-4dcf-4544-acb6-fd4285bf1d86"],
Cell[37673, 930, 6405, 143, 278, "Input",ExpressionUUID->"b83d350d-b075-403e-b02c-9f33cc86cb41"],
Cell[44081, 1075, 289, 6, 30, "Input",ExpressionUUID->"b15281b5-bc91-41ff-ae5b-f0ff6c5e671c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[44419, 1087, 329, 6, 38, "Subsection",ExpressionUUID->"8c824cc9-4e9a-4e2f-b460-bfa5b4fe890a"],
Cell[44751, 1095, 589, 10, 30, "Input",ExpressionUUID->"1661bccc-9935-41f8-bc61-05a95a83c1df"],
Cell[45343, 1107, 664, 17, 30, "Input",ExpressionUUID->"903cda10-ceff-421b-ad66-de44020b0004"],
Cell[46010, 1126, 528, 11, 30, "Input",ExpressionUUID->"d3ab5d75-8719-4946-a1fe-967ec710df5e"]
}, Open  ]]
}, Open  ]]
}
]
*)

